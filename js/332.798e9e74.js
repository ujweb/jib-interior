"use strict";(self["webpackChunkjib_interior"]=self["webpackChunkjib_interior"]||[]).push([[332],{2332:function(t,a,e){e.r(a),e.d(a,{default:function(){return f}});var i=e(6252),o=e(3577);const n={class:"container"},s=(0,i._)("span",{class:"d-inline-block"},"jib interior © 2022 All Rights Reserved.",-1),r={class:"d-inline-block"},l=(0,i.Uk)("圖片為練習使用，無商業用途｜"),d=(0,i.Uk)("登入後台");function c(t,a,e,c,h,u){const m=(0,i.up)("PageLoading"),p=(0,i.up)("header-component"),g=(0,i.up)("RouterView"),f=(0,i.up)("RouterLink"),v=(0,i.up)("SuccessModal");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(m),(0,i.Wm)(p,{onEmitToggleNav:u.openNavigation},null,8,["onEmitToggleNav"]),(0,i._)("main",null,[(0,i.Wm)(g,{onGetCart:u.getCart},null,8,["onGetCart"])]),(0,i._)("footer",null,[(0,i._)("div",n,[s,(0,i._)("span",r,[l,(0,i.Wm)(f,{to:"/login"},{default:(0,i.w5)((()=>[d])),_:1})])])]),(0,i.Wm)(v,null,{title:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(h.modal.title),1)])),default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(h.modal.content),1)])),_:1})],64)}var h=e(4983),u=e(3963),m={data(){return{cart:{data:[],final_total:0,total:0},modal:{title:"",temp:{},content:""}}},emits:["emit-toggle-nav"],components:{SuccessModal:u.Z},provide(){return{provideCart:this.cart}},mounted(){this.getCart(),this.$emitter.on("add-cart",(t=>{const{item:a,qty:e}=t;this.addCart(a,e)})),this.$emitter.on("get-cart",(()=>{this.getCart()}))},methods:{openNavigation(){document.body.classList.toggle("opened-nav")},openSuccessModal(){this.$emitter.emit("page-loading",!1),this.bsModal=(0,h.$7)("SuccessModal"),this.bsModal.show()},getCart(){const t="https://vue3-course-api.hexschool.io/v2/api/ujhwang/cart";this.$http.get(t).then((t=>{this.cart.data=t.data.data.carts,this.cart.final_total=0,this.cart.total=0,this.cart.data.forEach((t=>{this.cart.final_total+=t.final_total,this.cart.total+=t.total}))}))},addToCart(t){this.$emitter.emit("add-cart",{item:t,qty:t.qty})},addCart(t,a=1){const e="https://vue3-course-api.hexschool.io/v2/api/ujhwang/cart",i={data:{product_id:t.id,qty:a}};this.$http.post(e,i).then((t=>{this.modal.title=t.data.message,this.modal.content=`已將${t.data.data.product.title}加入購物車`,this.getCart(),this.openSuccessModal(),this.$emitter.emit("page-loading",!1)})).catch((()=>{})).finally((()=>{this.$emitter.emit("page-loading",!1)}))}},unmounted(){this.$emitter.off("add-cart"),this.$emitter.off("sending-sate"),this.$emitter.off("get-cart")}},p=e(3744);const g=(0,p.Z)(m,[["render",c]]);var f=g}}]);
//# sourceMappingURL=332.798e9e74.js.map