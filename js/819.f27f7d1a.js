"use strict";(self["webpackChunkjib_interior"]=self["webpackChunkjib_interior"]||[]).push([[819],{1347:function(t,a,e){e.d(a,{Z:function(){return h}});var l=e(6252);const o={class:"modal fade",id:"DangerModal","data-bs-keyboard":"false"},i={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},s={class:"modal-content"},d={class:"modal-body p-30"},n={class:"mb-2"},c=(0,l._)("div",{class:"d-flex align-items-center justify-content-end mt-2"},[(0,l._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"}," 我知道了 ")],-1);function m(t,a){return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",i,[(0,l._)("div",s,[(0,l._)("div",d,[(0,l._)("h2",n,[(0,l.WI)(t.$slots,"title")]),(0,l._)("p",null,[(0,l.WI)(t.$slots,"default")]),c])])])])}var r=e(3744);const p={},u=(0,r.Z)(p,[["render",m]]);var h=u},5354:function(t,a,e){e.d(a,{Z:function(){return g}});var l=e(6252);const o={class:"modal fade",id:"deleteModal","data-bs-keyboard":"false"},i={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},s={class:"modal-content"},d={class:"modal-body p-30"},n={class:"mb-2"},c={class:"d-flex align-items-center justify-content-end mt-2"},m=(0,l._)("button",{type:"button",class:"btn btn-light me-10","data-bs-dismiss":"modal"}," 取消 ",-1);function r(t,a,e,r,p,u){return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",i,[(0,l._)("div",s,[(0,l._)("div",d,[(0,l._)("h2",n,[(0,l.WI)(t.$slots,"title")]),(0,l._)("p",null,[(0,l.WI)(t.$slots,"default")]),(0,l._)("div",c,[m,(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:a[0]||(a[0]=a=>t.$emit("emit-delete",p.data))}," 確認 ")])])])])])}var p={props:["modal"],emits:["emit-delete"],data(){return{data:{}}},watch:{modal(){this.data=this.modal}}},u=e(3744);const h=(0,u.Z)(p,[["render",r]]);var g=h},4819:function(t,a,e){e.r(a),e.d(a,{default:function(){return zt}});var l=e(6252),o=e(3577),i=e(9963);const s=(0,l._)("h1",{class:"fs-2 mb-20"},"產品管理",-1),d={class:"d-flex align-items-center justify-content-between"},n=(0,l._)("option",{value:"all",selected:""},"全部商品",-1),c={class:"table-responsive py-20"},m={class:"table text-center align-middle"},r=(0,l._)("thead",{class:"table-light"},[(0,l._)("tr",null,[(0,l._)("th",{width:"4%",scope:"col"},"#"),(0,l._)("th",{width:"17%",scope:"col"},"id"),(0,l._)("th",{width:"13%",scope:"col"},"分類"),(0,l._)("th",{class:"text-start",scope:"col"},"產品名稱"),(0,l._)("th",{width:"10%",scope:"col"},"原價"),(0,l._)("th",{width:"10%",scope:"col"},"售價"),(0,l._)("th",{width:"8%",scope:"col"},"是否啟用"),(0,l._)("th",{width:"12%",scope:"col"},"編輯")])],-1),p={class:"text-center"},u={class:"text-start"},h={class:"form-check form-switch float-none d-inline-block mb-0"},g=["onClick"],b=["onClick"],_=["onClick"],y={key:0},v=(0,l._)("td",{class:"text-center",colspan:"8"},"目前尚無資料",-1),w=[v],f=(0,l.Uk)(" 是否刪除 "),k={class:"text-danger"},U=(0,l._)("br",null,null,-1),M=(0,l.Uk)(" 提醒您，刪除後將無法恢復 ");function $(t,a,e,v,$,x){const D=(0,l.up)("RouterLink"),P=(0,l.up)("pagination-nav"),C=(0,l.up)("ProductModal"),j=(0,l.up)("SuccessModal"),I=(0,l.up)("DangerModal"),z=(0,l.up)("DeleteModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[s,(0,l._)("div",d,[(0,l.wy)((0,l._)("select",{class:"form-select w-auto","onUpdate:modelValue":a[0]||(a[0]=t=>$.category.now=t),onChange:a[1]||(a[1]=(...t)=>x.getProduct&&x.getProduct(...t))},[n,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)($.category.array,(t=>((0,l.wg)(),(0,l.iD)("option",{key:`${t}`},(0,o.zw)(t),1)))),128))],544),[[i.bM,$.category.now]]),(0,l._)("button",{class:"btn btn-sm btn-primary",type:"button",onClick:a[2]||(a[2]=a=>{$.modal.title="新增產品",x.openProductModal($.modal.title,t.product)})}," 建立新的產品 ")]),(0,l._)("div",c,[(0,l._)("table",m,[r,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)($.products,((t,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,o.zw)(a+1),1),(0,l._)("td",null,[(0,l._)("small",null,(0,o.zw)(t.id),1)]),(0,l._)("td",p,(0,o.zw)(t.category),1),(0,l._)("td",u,[(0,l.Wm)(D,{to:`/product/${t.id}`,target:"_blank"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.title),1)])),_:2},1032,["to"])]),(0,l._)("td",null,(0,o.zw)(t.origin_price.toLocaleString()),1),(0,l._)("td",null,(0,o.zw)(t.price.toLocaleString()),1),(0,l._)("td",null,[(0,l._)("div",h,[(0,l._)("button",{class:(0,o.C_)(["form-check-input",{checked:1==t.is_enabled}]),onClick:a=>x.toggleEnabled(t),type:"button"},null,10,g)])]),(0,l._)("td",null,[(0,l._)("button",{class:"btn btn-sm btn-primary me-5",type:"button",onClick:a=>{$.modal.title="編輯產品",x.openProductModal($.modal.title,t)}}," 編輯 ",8,b),(0,l._)("button",{class:"btn btn-sm btn-bright-gray",type:"button",onClick:a=>{$.modal.title="刪除商品",x.openProductModal($.modal.title,t)}}," 刪除 ",8,_)])])))),128)),0===$.products?.length?((0,l.wg)(),(0,l.iD)("tr",y,w)):(0,l.kq)("",!0)])])]),(0,l.Wm)(P,{pages:$.paginations,onGetDatas:x.getProduct},null,8,["pages","onGetDatas"]),(0,l.Wm)(C,{modal:$.modal.temp,type:$.modal.title,onEmitUpdateData:x.updateProduct},{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)($.modal.title),1)])),_:1},8,["modal","type","onEmitUpdateData"]),(0,l.Wm)(j,null,{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)($.modal.title),1)])),default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)($.modal.content),1)])),_:1}),(0,l.Wm)(I,{modal:$.modal.temp},{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)($.modal.title),1)])),default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)($.modal.content),1)])),_:1},8,["modal"]),(0,l.Wm)(z,{modal:$.modal.temp,onEmitDeleteData:x.deleteProduct},{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)($.modal.title),1)])),default:(0,l.w5)((()=>[f,(0,l._)("b",k,(0,o.zw)($.modal.temp.title),1),U,M])),_:1},8,["modal","onEmitDeleteData"])],64)}var x=e(4983);const D={class:"modal fade needs-validation",id:"productModal","data-bs-backdrop":"static","data-bs-keyboard":"false",novalidate:""},P={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},C={class:"modal-content"},j={class:"modal-body p-30"},I={class:"mb-2"},z={class:"row"},S={class:"col-md-3 mb-20"},V=(0,l._)("label",{class:"mb-10",for:"title"},"請輸入產品名稱",-1),W={class:"col-md-3 mb-20"},E=(0,l._)("label",{class:"mb-10",for:"category"},"請輸入分類",-1),Z=(0,l.uE)('<option selected disabled>請選擇產品分類</option><option value="沙發">沙發</option><option value="桌子">桌子</option><option value="椅子">椅子</option><option value="系統櫃 / 收納櫃">系統櫃 / 收納櫃</option><option value="床組 / 寢具">床組 / 寢具</option><option value="燈具照明">燈具照明</option><option value="廚房 / 餐具">廚房 / 餐具</option>',8),F=[Z],O={class:"col-md-2 mb-20"},H=(0,l._)("label",{class:"mb-10",for:"unit"},"請輸入單位",-1),J={class:"col-md-2 mb-20"},N=(0,l._)("label",{class:"mb-10",for:"origin_price"},"請輸入原價",-1),Y={class:"col-md-2 mb-20"},K=(0,l._)("label",{class:"mb-10",for:"selling"},"請輸入售價",-1),L={class:"col-md-12 mb-20"},q={class:"d-flex align-items-center justify-content-between mb-10"},G=(0,l._)("div",{class:"fs-3"}," 請輸入網址或上傳圖片 ",-1),R=["disabled"],A=["disabled"],B={class:"row"},Q={class:"col-md-4"},T={class:"row"},X=(0,l._)("label",{class:"visually-hidden",for:"floatingMainPic"},"請輸入網址或上傳圖片",-1),tt={class:"col-md-4 position-relative"},at=(0,l._)("button",{class:"d-block w-100 h-100 btn btn-sm btn-light",type:"button"}," 上傳圖片 ",-1),et=(0,l._)("label",{for:"mainFile",class:"position-absolute"},null,-1),lt=["src"],ot={class:"row"},it=["id","onUpdate:modelValue"],st=["for"],dt={class:"col-md-4 position-relative ps-0"},nt=(0,l._)("button",{class:"d-block w-100 h-100 btn btn-sm btn-light",type:"button"}," 上傳圖片 ",-1),ct=(0,l._)("label",{for:"subFile",class:"position-absolute"},null,-1),mt=["data-index"],rt=["src","alt"],pt={class:"col-md-12"},ut={class:"row"},ht={class:"col-md-6 mb-20"},gt=(0,l._)("label",{class:"mb-10",for:"description"},"請輸入產品描述",-1),bt={class:"col-md-6 mb-20"},_t=(0,l._)("label",{class:"mb-10",for:"content"},"請輸入說明內容",-1),yt={class:"form-check mb-2"},vt=(0,l._)("label",{class:"form-check-label",for:"checkEnable"}," 是否啟用 ",-1),wt={class:"d-flex align-items-center justify-content-end mt-2"},ft=(0,l._)("button",{type:"button",class:"btn btn-bright-gray me-10","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(t,a,e,s,d,n){return(0,l.wg)(),(0,l.iD)("form",D,[(0,l._)("div",P,[(0,l._)("div",C,[(0,l._)("div",j,[(0,l._)("h2",I,[(0,l.WI)(t.$slots,"title")]),(0,l._)("div",z,[(0,l._)("div",S,[V,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入產品名稱","onUpdate:modelValue":a[0]||(a[0]=t=>d.data.title=t)},null,512),[[i.nr,d.data.title]])]),(0,l._)("div",W,[E,(0,l.wy)((0,l._)("select",{id:"category",class:"form-select","onUpdate:modelValue":a[1]||(a[1]=t=>d.data.category=t)},F,512),[[i.bM,d.data.category]])]),(0,l._)("div",O,[H,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":a[2]||(a[2]=t=>d.data.unit=t)},null,512),[[i.nr,d.data.unit]])]),(0,l._)("div",J,[N,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":a[3]||(a[3]=t=>d.data.origin_price=t)},null,512),[[i.nr,d.data.origin_price]])]),(0,l._)("div",Y,[K,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"selling",placeholder:"請輸入售價","onUpdate:modelValue":a[4]||(a[4]=t=>d.data.price=t)},null,512),[[i.nr,d.data.price]])]),(0,l._)("div",L,[(0,l._)("div",q,[G,!d.data.imagesUrl?.length||d.data.imagesUrl[d.data.imagesUrl.length-1]?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-sm btn-primary",type:"button",onClick:a[5]||(a[5]=(...t)=>n.addImage&&n.addImage(...t)),disabled:2===d.data.imagesUrl?.length&&""!==d.data.imagesUrl?.[1]}," 新增圖片 ",8,R)):((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn btn-sm btn-light",type:"button",onClick:a[6]||(a[6]=(...t)=>n.removeImage&&n.removeImage(...t)),disabled:2===d.data.imagesUrl?.length&&""!==d.data.imagesUrl?.[1]}," 刪除圖片 ",8,A))]),(0,l._)("div",B,[(0,l._)("div",Q,[(0,l._)("div",T,[(0,l._)("div",{class:(0,o.C_)(["col-md-8",{"col-md-12":d.data.imageUrl,"pe-0":!d.data.imageUrl}])},[X,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"floatingMainPic","onUpdate:modelValue":a[7]||(a[7]=t=>d.data.imageUrl=t),placeholder:"請輸入網址或上傳圖片"},null,512),[[i.nr,d.data.imageUrl]])],2),(0,l.wy)((0,l._)("div",tt,[at,et,(0,l._)("input",{type:"file",class:"d-block w-100 h-100 position-absolute top-0 start-0 opacity-0",id:"mainFile",placeholder:"上傳圖片","data-type":"main",onChange:a[8]||(a[8]=(...t)=>n.uploadImage&&n.uploadImage(...t))},null,32)],512),[[i.F8,!d.data.imageUrl]])]),d.data.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,class:"img-fluid mt-5",src:d.data.imageUrl,alt:"主圖"},null,8,lt)):(0,l.kq)("",!0)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.data.imagesUrl,((t,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"col-md-4",key:e},[(0,l._)("div",ot,[(0,l._)("div",{class:(0,o.C_)(["col-md-8",{"col-md-12":t}])},[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"floatingPic"+e,"onUpdate:modelValue":t=>d.data.imagesUrl[e]=t,placeholder:"請輸入網址或上傳圖片"},null,8,it),[[i.nr,d.data.imagesUrl[e]]]),(0,l._)("label",{for:"floatingPic"+e,class:"visually-hidden"},"請輸入網址或上傳圖片",8,st)],2),(0,l.wy)((0,l._)("div",dt,[nt,ct,(0,l._)("input",{type:"file",class:"d-block w-100 h-100 position-absolute top-0 start-0 opacity-0",id:"subFile",placeholder:"上傳圖片","data-index":e,"data-type":"sub",onChange:a[9]||(a[9]=(...t)=>n.uploadImage&&n.uploadImage(...t))},null,40,mt)],512),[[i.F8,!t]])]),(0,l.wy)((0,l._)("img",{class:"img-fluid mt-5",src:t,alt:`配圖-${e}`},null,8,rt),[[i.F8,t]])])))),128))])]),(0,l._)("div",pt,[(0,l._)("div",ut,[(0,l._)("div",ht,[gt,(0,l.wy)((0,l._)("textarea",{class:"form-control",id:"description",style:{height:"100px"},placeholder:"請輸入產品描述","onUpdate:modelValue":a[10]||(a[10]=t=>d.data.description=t)},null,512),[[i.nr,d.data.description]])]),(0,l._)("div",bt,[_t,(0,l.wy)((0,l._)("textarea",{class:"form-control",id:"content",style:{height:"100px"},"onUpdate:modelValue":a[11]||(a[11]=t=>d.data.content=t),placeholder:"請輸入說明內容"},null,512),[[i.nr,d.data.content]])])]),(0,l._)("div",yt,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",value:"is_enabled",id:"checkEnable","onUpdate:modelValue":a[12]||(a[12]=t=>d.data.is_enabled=t),"true-value":1,"false-value":0},null,512),[[i.e8,d.data.is_enabled,void 0,{number:!0}]]),vt])])]),(0,l._)("div",wt,[ft,(0,l._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:a[13]||(a[13]=a=>t.$emit("emit-update-data",d.title,d.data))}," 確認 ")])])])])])}var Ut={data(){return{data:{},title:null,return:{title:null,content:null}}},props:["modal","type"],emits:["emit-update-data"],methods:{uploadImage(t){const a=new FormData;a.append("file-to-upload",t.target.files[0]),this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/upload",a).then((a=>{"main"===t.target.dataset.type?this.data.imageUrl=a.data.imageUrl:"sub"===t.target.dataset.type&&(this.data.imagesUrl[t.target.dataset.index]=a.data.imageUrl)})).catch((()=>{}))},addImage(){void 0===this.data.imagesUrl&&(this.data.imagesUrl=[]),this.data.imagesUrl.push("")},removeImage(){this.data.imagesUrl.pop()}},watch:{modal(){this.data=this.modal,this.title=this.type}}},Mt=e(3744);const $t=(0,Mt.Z)(Ut,[["render",kt]]);var xt=$t,Dt=e(3963),Pt=e(1347),Ct=e(5354),jt={data(){return{page:1,products:[],category:{now:"all",array:[]},paginations:{},bsModal:null,modal:{title:"",content:"",temp:{}}}},emits:["page-loading"],components:{ProductModal:xt,SuccessModal:Dt.Z,DangerModal:Pt.Z,DeleteModal:Ct.Z},mounted(){this.$emitter.emit("page-loading",!0),this.getProducts(),this.getProduct()},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/products/all";this.$emitter.emit("page-loading",!0),this.$http.get(t).then((t=>{this.category.array=[...new Set(Object.values(t.data.products).map((t=>t.category)))]})).catch((()=>{}))},getProduct(t=1){let a="";a="all"===this.category.now?`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/products?page=${t}`:`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/products?page=${t}&category=${this.category.now}`,this.$emitter.emit("page-loading",!0),this.$http.get(a).then((t=>{this.paginations=t.data.pagination,this.products=t.data.products,this.$emitter.emit("page-loading",!1)})).catch((()=>{}))},updateProduct(t,a){this.$emitter.emit("page-loading",!0);const e={data:a};let l=null,o=null;"新增產品"===t?(l="https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product",o="post"):"編輯產品"===t&&(l=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product/${this.modal.temp.id}`,o="put"),this.$http[o](l,e).then((a=>{"新增產品"===t?this.modal.title="新增成功":"編輯產品"===t&&(this.modal.title="修改成功"),this.modal.content=a.data.message,this.modal.temp={}})).catch((a=>{"新增產品"===t?this.modal.title="新增失敗":"編輯產品"===t&&(this.modal.title="修改失敗"),this.modal.content=a.response.data.message})).finally((()=>{this.getProduct(),this.openSuccessModal()}))},deleteProduct(t){const a=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product/${t.id}`;this.$emitter.emit("page-loading",!0),this.$http.delete(a).then((t=>{this.modal.title="刪除成功",this.modal.content=t.data.message,this.getProduct()})).catch((t=>{this.modal.title="刪除失敗",this.modal.content=t.response.data.message})).finally((()=>{this.openSuccessModal(this.modal.title,this.modal.content)}))},toggleEnabled(t){const a=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product/${t.id}`;this.$emitter.emit("page-loading",!0),this.modal.temp=t;const e={data:this.modal.temp};0===this.modal.temp.is_enabled||void 0===this.modal.temp.is_enabled?this.modal.temp.is_enabled=1:1===this.modal.temp.is_enabled&&(this.modal.temp.is_enabled=0),this.$http.put(a,e).then((t=>{this.modal.title="修改成功",this.modal.content=t.data.message,this.getProduct()})).catch((t=>{this.modal.title="修改失敗",this.modal.content=t.response.data.message})).finally((()=>{this.openSuccessModal(this.modal.title,this.modal.content)}))},openProductModal(t,a){this.$emitter.emit("page-loading",!1),"編輯產品"===t?(this.bsModal=(0,x.$7)("productModal"),this.modal.temp=JSON.parse(JSON.stringify(a))):"新增產品"===t?(this.bsModal=(0,x.$7)("productModal"),this.modal.temp={}):"刪除商品"===t&&(this.bsModal=(0,x.$7)("deleteModal"),this.modal.temp=JSON.parse(JSON.stringify(a))),this.bsModal.show()},openSuccessModal(){this.$emitter.emit("page-loading",!1),this.bsModal=(0,x.$7)("SuccessModal"),this.bsModal.show()},openDangerModal(t){this.$emitter.emit("page-loading",!1),this.modal.title=t.title,this.modal.content=t.content,this.bsModal=(0,x.$7)("DangerModal"),this.bsModal.show()}}};const It=(0,Mt.Z)(jt,[["render",$]]);var zt=It}}]);
//# sourceMappingURL=819.f27f7d1a.js.map